#!/usr/bin/env bash

# Resolve the directory where this script lives
if [ -n "$BASH_VERSION" ]; then
    SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
elif [ -n "$ZSH_VERSION" ]; then
    SCRIPT_DIR="$(cd "$(dirname "${(%):-%N}")" && pwd)"
else
    SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
fi

ZDE_HOME="$(cd "$SCRIPT_DIR/.." && pwd)/home"

set_vars() {
    cat <<EOF
export ZDE_HOME="$ZDE_HOME"
export ZDE_PATH="\$ZDE_HOME/.."
export ZOS_PATH="\$ZDE_HOME/Zeal-8-bit-OS"
export ZVB_SDK_PATH="\$ZDE_HOME/Zeal-VideoBoard-SDK"
export ZGDK_PATH="\$ZDE_HOME/zeal-game-dev-kit"
export ZAR_PATH="\$ZDE_HOME/zeal-archiver"
export COREUTILS_PATH="\$ZDE_HOME/zeal-coreutils"

export PATH="\$ZDE_PATH:\$PATH"
export PATH="\$ZOS_PATH/tools:\$PATH"
export PATH="\$ZVB_SDK_PATH/tools/zeal2gif:\$PATH"
export PATH="\$ZVB_SDK_PATH/tools/tiled2zeal:\$PATH"
export PATH="\$ZDE_HOME/zeal-archiver:\$PATH"
export PATH="\$ZDE_PATH:\$PATH"
EOF
}

# If we are sourced, apply directly.
# If not, just print so it can be used with eval.
if [ "${BASH_SOURCE[0]}" != "$0" ] || [ -n "$ZSH_EVAL_CONTEXT" ]; then
    eval "$(set_vars)"
else
    set_vars
fi
